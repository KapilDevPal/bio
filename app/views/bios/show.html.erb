<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <!-- Header -->
  <div class="text-center mb-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-2 font-playfair">
      <i class="fas fa-heart text-pink-500 mr-2"></i>
      Marriage Biodata
    </h1>
    <p class="text-gray-600">शादी का बायोडाटा / ਵਿਆਹ ਦਾ ਬਾਇਓਡਾਟਾ / लग्नाचा बायोडाटा</p>
  </div>

  <!-- Action Buttons -->
  <div class="flex justify-center mb-8">
    <div class="flex flex-wrap gap-3">
      <%= link_to download_pdf_bio_path(@bio, format: :pdf), 
          class: "bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg transition-colors shadow-lg",
          target: "_blank" do %>
        <i class="fas fa-download mr-2"></i>
        Download PDF
      <% end %>
      
      <button onclick="shareBiodata()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-colors shadow-lg">
        <i class="fas fa-share mr-2"></i>
        Share
      </button>
      
      <%= link_to root_path, 
          class: "bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition-colors shadow-lg" do %>
        <i class="fas fa-plus mr-2"></i>
        Create New
      <% end %>
    </div>
  </div>

  <!-- Biodata Content -->
  <div class="bg-white rounded-lg shadow-lg border border-gray-200 p-8">
    <!-- Sections -->
    <% @bio.sections.ordered.each do |section| %>
      <div class="section mb-8">
        <h2 class="text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b-2 border-pink-200 font-playfair">
          <i class="fas fa-folder text-blue-500 mr-3"></i>
          <%= section.name %>
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <% section.fields.ordered.each do |field| %>
            <% if field.label.present? && field.value.present? %>
              <div class="field-card">
                <div class="text-sm font-medium text-gray-600 mb-2 uppercase tracking-wide">
                  <%= field.label %>
                </div>
                <div class="text-gray-900 font-medium text-lg">
                  <%= field.value %>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
        
        <!-- Empty state for section -->
        <% if section.fields.ordered.none? { |f| f.label.present? && f.value.present? } %>
          <div class="text-gray-500 text-center py-8 italic">
            <i class="fas fa-info-circle mr-2 text-2xl"></i>
            <p class="text-lg">No information available for this section</p>
          </div>
        <% end %>
      </div>
    <% end %>

    <!-- Footer -->
    <div class="text-center mt-12 pt-8 border-t-2 border-gray-200">
      <p class="text-gray-600 mb-2">
        Generated on <%= Date.current.strftime("%B %d, %Y") %>
      </p>
      <p class="text-sm text-gray-500">
        <i class="fas fa-heart text-pink-500"></i> 
        Created with Marriage Biodata Generator
      </p>
    </div>
  </div>

  <!-- Share Modal -->
  <div id="share-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-lg p-6 max-w-md w-full">
        <div class="text-center">
          <h3 class="text-lg font-semibold text-gray-900 mb-4">Share Biodata</h3>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Public Link:</label>
              <div class="flex">
                <input type="text" id="share-url" value="<%= @bio.public_url %>" 
                       class="flex-1 px-3 py-2 border border-gray-300 rounded-l-md text-sm" readonly>
                <button onclick="copyShareUrl()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-r-md">
                  <i class="fas fa-copy"></i>
                </button>
              </div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">QR Code for Editing:</label>
              <div id="qr-code" class="mb-4"></div>
            </div>
          </div>
          <button onclick="closeShareModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .font-playfair {
    font-family: 'Playfair Display', serif;
  }
  
  .section h2 {
    color: #374151;
    position: relative;
  }
  
  .field-card {
    background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
    padding: 20px;
    border-radius: 12px;
    border-left: 4px solid #ec4899;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
  }
  
  .field-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  
  .field-card .text-sm {
    color: #6b7280;
    font-weight: 500;
  }
  
  .field-card .text-lg {
    color: #111827;
    font-weight: 600;
  }
</style>

<script>
  function shareBiodata() {
    const modal = document.getElementById('share-modal');
    const qrContainer = document.getElementById('qr-code');
    
    // Generate QR code for edit URL
    const editUrl = '<%= @bio.edit_url %>';
    qrContainer.innerHTML = `<img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(editUrl)}" alt="QR Code">`;
    
    modal.classList.remove('hidden');
  }
  
  function closeShareModal() {
    document.getElementById('share-modal').classList.add('hidden');
  }
  
  function copyShareUrl() {
    const urlInput = document.getElementById('share-url');
    urlInput.select();
    urlInput.setSelectionRange(0, 99999);
    
    navigator.clipboard.writeText(urlInput.value).then(() => {
      // Show success message
      const button = event.target.closest('button');
      const originalText = button.innerHTML;
      button.innerHTML = '<i class="fas fa-check"></i>';
      button.classList.remove('bg-blue-500', 'hover:bg-blue-600');
      button.classList.add('bg-green-500');
      
      setTimeout(() => {
        button.innerHTML = originalText;
        button.classList.remove('bg-green-500');
        button.classList.add('bg-blue-500', 'hover:bg-blue-600');
      }, 2000);
    });
  }
  
  // Close modal when clicking outside
  document.getElementById('share-modal').addEventListener('click', function(e) {
    if (e.target === this) {
      closeShareModal();
    }
  });
</script>
